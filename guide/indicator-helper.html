<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üéØ Herramienta de Posicionamiento de Indicadores</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
        color: #fff;
        padding: 20px;
      }

      .header {
        text-align: center;
        padding: 2rem;
        background: rgba(255, 217, 15, 0.1);
        border-radius: 15px;
        margin-bottom: 2rem;
        border: 2px solid #ffd90f;
      }

      .header h1 {
        font-size: 2rem;
        color: #ffd90f;
        margin-bottom: 0.5rem;
      }

      .header p {
        color: #ccc;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: 1fr 350px;
        gap: 2rem;
      }

      .image-area {
        background: rgba(255, 255, 255, 0.05);
        padding: 2rem;
        border-radius: 15px;
        border: 2px solid rgba(255, 217, 15, 0.2);
      }

      .controls {
        background: rgba(255, 255, 255, 0.05);
        padding: 2rem;
        border-radius: 15px;
        border: 2px solid rgba(255, 217, 15, 0.2);
        position: sticky;
        top: 20px;
        max-height: calc(100vh - 40px);
        overflow-y: auto;
      }

      .file-input-wrapper {
        margin-bottom: 2rem;
        text-align: center;
      }

      .file-input-label {
        display: inline-block;
        background: linear-gradient(135deg, #ffd90f 0%, #ffa500 100%);
        color: #000;
        padding: 1rem 2rem;
        border-radius: 10px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .file-input-label:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(255, 217, 15, 0.5);
      }

      input[type="file"] {
        display: none;
      }

      .image-wrapper {
        position: relative;
        display: inline-block;
        max-width: 100%;
        cursor: crosshair;
        background: #000;
        border-radius: 10px;
        overflow: hidden;
      }

      #preview-image {
        display: block;
        max-width: 100%;
        height: auto;
      }

      .marker {
        position: absolute;
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #ffd90f 0%, #ffa500 100%);
        border: 3px solid #fff;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        cursor: move;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #000;
        box-shadow: 0 4px 15px rgba(255, 217, 15, 0.6);
        z-index: 10;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: translate(-50%, -50%) scale(1);
        }
        50% {
          transform: translate(-50%, -50%) scale(1.1);
        }
      }

      .marker:hover {
        background: #ff6b00;
        animation: none;
      }

      .marker::after {
        content: attr(data-number);
      }

      .coords-display {
        background: rgba(0, 0, 0, 0.9);
        color: #0f0;
        font-family: "Courier New", monospace;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        font-size: 0.9rem;
        line-height: 1.6;
        border: 1px solid rgba(255, 217, 15, 0.3);
      }

      .coords-display strong {
        color: #ffd90f;
      }

      .indicator-list {
        margin-bottom: 2rem;
      }

      .indicator-item {
        background: rgba(255, 255, 255, 0.05);
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 0.5rem;
        border-left: 3px solid #ffd90f;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .indicator-item:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .indicator-number {
        background: #ffd90f;
        color: #000;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 0.75rem;
      }

      .indicator-coords {
        flex: 1;
        font-size: 0.85rem;
        color: #ccc;
      }

      .btn-delete {
        background: #ff4444;
        color: #fff;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 5px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: all 0.2s ease;
      }

      .btn-delete:hover {
        background: #cc0000;
      }

      .btn-primary {
        background: linear-gradient(135deg, #ffd90f 0%, #ffa500 100%);
        color: #000;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        width: 100%;
        margin-bottom: 0.5rem;
        transition: all 0.3s ease;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 217, 15, 0.5);
      }

      .code-output {
        background: rgba(0, 0, 0, 0.9);
        color: #0f0;
        font-family: "Courier New", monospace;
        padding: 1rem;
        border-radius: 8px;
        margin-top: 1rem;
        font-size: 0.8rem;
        line-height: 1.5;
        max-height: 300px;
        overflow-y: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
        border: 1px solid rgba(255, 217, 15, 0.3);
      }

      .instructions {
        background: rgba(255, 217, 15, 0.1);
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        border: 1px solid rgba(255, 217, 15, 0.3);
      }

      .instructions h3 {
        color: #ffd90f;
        margin-bottom: 0.5rem;
        font-size: 1rem;
      }

      .instructions ul {
        margin-left: 1.5rem;
        color: #ccc;
        font-size: 0.85rem;
      }

      .instructions li {
        margin-bottom: 0.25rem;
      }

      @media (max-width: 1200px) {
        .container {
          grid-template-columns: 1fr;
        }

        .controls {
          position: static;
          max-height: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>üéØ Herramienta de Posicionamiento de Indicadores</h1>
      <p>
        Haz clic en la imagen para a√±adir marcadores y obt√©n el c√≥digo HTML
        autom√°ticamente
      </p>
    </div>

    <div class="container">
      <div class="image-area">
        <div class="file-input-wrapper">
          <label for="image-upload" class="file-input-label">
            üìÅ Cargar Screenshot
          </label>
          <input type="file" id="image-upload" accept="image/*" />
        </div>

        <div class="image-wrapper" id="image-container">
          <img
            id="preview-image"
            src=""
            alt="Vista previa"
            style="display: none"
          />
        </div>

        <div class="coords-display" id="coords-display" style="display: none">
          <strong>Posici√≥n del cursor:</strong><br />
          X: <span id="cursor-x">-</span>% | Y:
          <span id="cursor-y">-</span>%<br />
          <strong>Haz clic para a√±adir marcador</strong>
        </div>
      </div>

      <div class="controls">
        <div class="instructions">
          <h3>üìã Instrucciones:</h3>
          <ul>
            <li>1. Carga un screenshot</li>
            <li>2. Haz clic donde quieras indicadores</li>
            <li>3. Arrastra marcadores para ajustar</li>
            <li>4. Copia el c√≥digo HTML generado</li>
          </ul>
        </div>

        <div class="indicator-list" id="indicator-list">
          <h3 style="color: #ffd90f; margin-bottom: 1rem">Marcadores:</h3>
          <div id="markers-container">
            <p style="color: #888; font-size: 0.9rem">
              No hay marcadores. Haz clic en la imagen para a√±adir.
            </p>
          </div>
        </div>

        <button class="btn-primary" onclick="generateCode()">
          üìã Generar C√≥digo HTML
        </button>
        <button class="btn-primary" onclick="clearMarkers()">
          üóëÔ∏è Limpiar Todo
        </button>

        <div class="code-output" id="code-output" style="display: none"></div>
      </div>
    </div>

    <script>
      let markers = [];
      let markerCounter = 1;
      let isDragging = false;
      let currentMarker = null;

      const imageUpload = document.getElementById("image-upload");
      const previewImage = document.getElementById("preview-image");
      const imageContainer = document.getElementById("image-container");
      const coordsDisplay = document.getElementById("coords-display");
      const cursorX = document.getElementById("cursor-x");
      const cursorY = document.getElementById("cursor-y");
      const markersContainer = document.getElementById("markers-container");
      const codeOutput = document.getElementById("code-output");

      // Cargar imagen
      imageUpload.addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (event) => {
            previewImage.src = event.target.result;
            previewImage.style.display = "block";
            coordsDisplay.style.display = "block";
            clearMarkers();
          };
          reader.readAsDataURL(file);
        }
      });

      // Mostrar coordenadas al mover el mouse
      imageContainer.addEventListener("mousemove", (e) => {
        if (!previewImage.src || isDragging) return;

        const rect = previewImage.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;

        cursorX.textContent = x.toFixed(1);
        cursorY.textContent = y.toFixed(1);
      });

      // A√±adir marcador al hacer clic
      imageContainer.addEventListener("click", (e) => {
        if (
          !previewImage.src ||
          isDragging ||
          e.target.classList.contains("marker")
        )
          return;

        const rect = previewImage.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;

        addMarker(x, y);
      });

      function addMarker(x, y) {
        const marker = document.createElement("div");
        marker.className = "marker";
        marker.dataset.number = markerCounter;
        marker.dataset.x = x.toFixed(1);
        marker.dataset.y = y.toFixed(1);
        marker.style.left = x + "%";
        marker.style.top = y + "%";

        // Hacer el marcador arrastrable
        marker.addEventListener("mousedown", startDrag);

        imageContainer.appendChild(marker);
        markers.push({
          id: markerCounter,
          element: marker,
          x: x.toFixed(1),
          y: y.toFixed(1),
        });

        updateMarkersList();
        markerCounter++;
      }

      function startDrag(e) {
        e.preventDefault();
        isDragging = true;
        currentMarker = e.target;

        document.addEventListener("mousemove", drag);
        document.addEventListener("mouseup", stopDrag);
      }

      function drag(e) {
        if (!isDragging || !currentMarker) return;

        const rect = previewImage.getBoundingClientRect();
        let x = ((e.clientX - rect.left) / rect.width) * 100;
        let y = ((e.clientY - rect.top) / rect.height) * 100;

        // Limitar a los bordes de la imagen
        x = Math.max(0, Math.min(100, x));
        y = Math.max(0, Math.min(100, y));

        currentMarker.style.left = x + "%";
        currentMarker.style.top = y + "%";
        currentMarker.dataset.x = x.toFixed(1);
        currentMarker.dataset.y = y.toFixed(1);

        // Actualizar en el array
        const markerId = parseInt(currentMarker.dataset.number);
        const markerData = markers.find((m) => m.id === markerId);
        if (markerData) {
          markerData.x = x.toFixed(1);
          markerData.y = y.toFixed(1);
        }

        updateMarkersList();
      }

      function stopDrag() {
        isDragging = false;
        currentMarker = null;
        document.removeEventListener("mousemove", drag);
        document.removeEventListener("mouseup", stopDrag);
      }

      function updateMarkersList() {
        if (markers.length === 0) {
          markersContainer.innerHTML =
            '<p style="color: #888; font-size: 0.9rem;">No hay marcadores. Haz clic en la imagen para a√±adir.</p>';
          return;
        }

        markersContainer.innerHTML = markers
          .map(
            (marker) => `
        <div class="indicator-item">
          <div class="indicator-number">${marker.id}</div>
          <div class="indicator-coords">
            top: ${marker.y}%<br>
            left: ${marker.x}%
          </div>
          <button class="btn-delete" onclick="deleteMarker(${marker.id})">üóëÔ∏è</button>
        </div>
      `
          )
          .join("");
      }

      function deleteMarker(id) {
        const markerIndex = markers.findIndex((m) => m.id === id);
        if (markerIndex !== -1) {
          markers[markerIndex].element.remove();
          markers.splice(markerIndex, 1);
          updateMarkersList();
        }
      }

      function clearMarkers() {
        markers.forEach((marker) => marker.element.remove());
        markers = [];
        markerCounter = 1;
        updateMarkersList();
        codeOutput.style.display = "none";
      }

      function generateCode() {
        if (markers.length === 0) {
          alert("‚ö†Ô∏è Primero a√±ade algunos marcadores en la imagen");
          return;
        }

        let html = "<!-- Indicadores generados autom√°ticamente -->\n\n";

        markers.forEach((marker) => {
          html += `<!-- Indicador ${marker.id} -->\n`;
          html += `<div class="indicator indicator-number" style="top: ${marker.y}%; left: ${marker.x}%;">\n`;
          html += `  ${marker.id}\n`;
          html += `</div>\n`;
          html += `<div class="indicator indicator-tooltip" style="top: ${
            parseFloat(marker.y) - 4
          }%; left: ${parseFloat(marker.x) - 8}%;">\n`;
          html += `  Descripci√≥n del indicador ${marker.id}\n`;
          html += `</div>\n\n`;
        });

        codeOutput.textContent = html;
        codeOutput.style.display = "block";

        // Copiar al portapapeles
        navigator.clipboard
          .writeText(html)
          .then(() => {
            alert("‚úÖ C√≥digo HTML copiado al portapapeles!");
          })
          .catch(() => {
            alert(
              "‚ö†Ô∏è No se pudo copiar autom√°ticamente. Copia manualmente el c√≥digo de abajo."
            );
          });
      }
    </script>
  </body>
</html>
